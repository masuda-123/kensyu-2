<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Edit</title>
		<!-- cssを読み込む  -->
		<link rel="stylesheet" media="all" th:href="@{/css/style.css}"/>
		<!-- jsファイルで使う変数を宣言し、初期値を設定   -->
		<script th:inline="javascript">
			var i = /*[[${answers.length}]]*/0;
		</script>
		<!-- jsファイルを読み込む  -->
		<script type="text/javascript" th:src="@{/js/add_answer_form.js}"></script>
		<script type="text/javascript" th:src="@{/js/delete_answer_form.js}"></script>
	</head>
	<body>
		<div class="btn_area">
			<!-- Topに遷移させるボタン  -->
			<button onclick="location.href='../top'">top</button>
			<!--  logoutさせるボタン -->
			<form th:action="@{/logout}" method="post">
				<input type="submit" value="logout">
			</form>
		</div>
		<!-- formタグで入力されたデータを/edit/confirmにpostで送信する  -->
		<form th:action="@{/edit/confirm}" method="post">
			<div class="question_id_area">
				<label>問題番号:</label>
				<!-- 問題のidを表示  -->
				<p th:text="${questionId}"></p>
			</div>
			<!-- 隠し入力欄に、問題idを設定  -->
			<input type="hidden" id="questionId" name="questionId" th:value="${questionId}">
			<div class="question_form_area">
				<label for="question">問題:</label>
				<!-- 問題文を入力する欄（初期値として問題文を設定）  -->
				<textarea id="question" name="question">[[${question}]]</textarea>
			</div>
			<div class="answer_forms_area">
				<label for="answer">答え:</label>
				<div class="answer_forms">
					<!-- 答えの数だけ処理を繰り返す  -->
					<th:block th:each="answer, ansStatus: ${answers}">
						<div class="answer_form" th:id="'answer_form' + ${ansStatus.count}">
							<!-- 答えの文を表示  -->
							<input type="text" id="answer" name="answer" th:value="${answer}">
							<!-- 答えidより渡された答えの数が少なかった場合、もしくは同じだった場合-->
							<th:block th:if="${answers.length <= answersId.length}">
								<!-- 隠し入力欄に、答えidを設定  -->
								<input type="hidden" id="answerId" name="answerId" th:value="${answersId[ansStatus.index]}">
							</th:block>
							<!-- 1つ目の答え以外の場合  -->
							<th:block th:if="${ansStatus.index != 0}">
								<!-- 削除ボタンを表示し、ボタンを押下後、jsファイルのdeleteForm関数を実行（引数としてタグのidを渡す）  -->
								<button type="button" th:onclick="|deleteForm(answer_form__${ansStatus.count}__)|">削除</button>
							</th:block>
						</div>
					</th:block>
					<!-- 答えidより渡された答えの数が多かった場合-->
					<th:block th:if="${answers.length > answersId.length}">
						<!-- 答えidの数だけ処理を繰り返す  -->
						<th:block th:each="answerId : ${answersId}">
							<!-- 隠し入力欄に、答えidを設定  -->
							<input type="hidden" id="answerId" name="answerId" th:value="${answerId}">
						</th:block>
					</th:block>
				</div>
			</div>
			<div class="bottom_btn_area">
				<!-- ボタンを押下後、list画面に戻る  -->
				<button type="button" onclick="location.href='../list'">戻る</button>
				<!-- フォームデータを送信するボタン -->
				<input type="submit" value="確認">
				<!-- ボタンを押下後、jsファイルのaddForm関数を実行  -->
				<button type="button" onclick="addForm()">追加</button>
			</div>
		</form>
	</body>
</html>
